---
title: "Investigating Indie"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(ggplot2)
library(spotifyr)
library(compmus)
library(plotly)
library(gridExtra)
```

### What makes a song "Indie"? 
  There is an ongoing debate on whether indie music can be considered a genre. Indie is short for “independent” and refers to music released by an artist independently rather than with a record label. Some bands that are considered to be indie, such as Arcade Fire, however, work with a record label. This begs the question: What makes indie music indie? Some argue that indie music has a specific sound, but what are its defining characteristics that allows Spotify to create “Indie” playlists? I hope to investigate this question with my corpus containing songs from three different indie sub-genre playlists created by Spotify: “Indie Rock Mix,” “Indie Pop Mix,” and “Indie Folk Mix.” Comparing songs from these different sub-genres will clarify what characteristics of a song Spotify considers to be indie. The main limitation of my investigation is that the songs in the playlists are recommended by Spotify for my specific account. Hence, it may not reflect the most popular indie songs nor be representative of indie music as a whole. “The Less I Know the Better” by Tame Impala is a typical indie song in my corpus, because it cannot be tied to another genre. Two atypical songs are “Sunflower” by Harry Styles and “Work Song” by Hozier, because neither of these artists are considered to be indie artists. These songs will be good to analyze since they may have the characteristics of a typical indie song, but they are made by non-indie artists.
  
  
```{r}

```


### Indie Rock is Energetic
```{r}
folk <- get_playlist_audio_features("", "6P82OCSEpo1VrZ4TZ2W5jK")
pop <- get_playlist_audio_features("", "3HDdTtyB76aLDc4wpGFCX4")
rock <- get_playlist_audio_features("","5dMoFfrgm8aOOkneQjt6LT")

indie <-
  bind_rows(
    folk |> mutate(category = "Indie Folk"),
    pop |> mutate(category = "Indie Pop"),
    rock |> mutate(category= "Indie Rock")
  )

dens_energy <- ggplot(indie, aes(x = energy, color = category)) + geom_histogram(fill="white") + facet_wrap(~category) + 
  labs(x = "Energy", y = "Density", 
       title = "Comparing the Distribution of Energy Between Indie Subgenres",
       color = "Indie Subgenres") 
dens_energy
```

*** 
This histogram shows that energy is widespread over the Indie genre as a whole. A song's energy cannot tell us whether it belongs under the "Indie" label. What is clear, however, is that Spotify's "Indie Rock" playlist holds the songs with the most energy. Hence, Indie Rock separates itself from the other two subgenres through Spotify's energy audio feature.

### Indie Rock Has The Energy, Indie Folk Is For The Feels {data-commentary-width=400}
```{r}
energy_valence <- ggplot(indie, aes(x = energy, y = loudness, color=valence, label = track.name)) + geom_point() + facet_wrap(~category) + scale_color_gradient(low = "yellow", high = "purple") + labs(x = "Energy", y = "Loudness") + geom_smooth(method=lm)
ggplotly(energy_valence)
```

***

Consistent with the last histogram, energy and loudness are widespread over the Indie genre as a whole. What can be observed again is that Spotify's "Indie Rock" playlist holds the songs with the most energy and loudness, followed by "Indie Pop" and "Indie Folk." Hence, the energy and loudness features can help us distinguish Indie songs from each other and categorize them into sub-genres. 
Indie Folk separates itself from the other two sub-genres through the valence feature. Compared to Rock and Pop, most of the Indie Folk songs have a negative valence. In other words, Indie Folk is a sad sub-genre.
The song "j's lullaby" by Delaney Bailey is a clear outlier in this graph. It has the least energy and loudness by far compared to not only the other indie pop songs but also compared to the songs in the other two sub-genres. Another atypical song is "Naked as We Came" by Iron & Wine since it is one of the few songs that is low in energy and loudness but has a positive valence. These songs will be further investigated.


### Energetic Indie Has A More Colorful Pitch Than Quiet Indie

```{r}
j_lullaby <-
  get_tidy_audio_analysis("7LNm1oWd6PniO9wRYpNY5o") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

j_lullaby_plot <- j_lullaby |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |>
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title = "Chromagram of \"j's lullaby\"\nby Delaney Bailey", subtitle = "Indie Pop, Lowest Energy,\nNegative Valence") +
  theme_minimal() +
  scale_fill_viridis_c() + theme(plot.title = element_text(face="bold", size=9), plot.subtitle = element_text(size=7), legend.title = element_text(size=6), legend.key.size = unit(0.4, 'cm'))

live_once <-
  get_tidy_audio_analysis("4fPBB44eDH71YohayI4eKV") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

live_once_plot <- live_once |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |>
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title = "Chromagram of \"You Only Live Once\"\nby The Strokes", subtitle = "Indie Rock, Highest Energy,\nPositive Valence") +
  theme_minimal() +
  scale_fill_viridis_c() + theme(plot.title = element_text(face="bold", size=9), plot.subtitle = element_text(size=7), legend.title = element_text(size=6), legend.key.size = unit(0.4, 'cm'))

naked <- get_tidy_audio_analysis("4FuBIkfhZMoRgrDiHL6TYG") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

naked_plot <- naked |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |>
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title = "Chromagram of \"Naked As We Came\"\nby Iron & Wine", subtitle = "Indie Folk, Low Energy,\nPositive Valence") +
  theme_minimal() +
  scale_fill_viridis_c() + theme(plot.title = element_text(face="bold", size=9), plot.subtitle = element_text(size=7), legend.title = element_text(size=6), legend.key.size = unit(0.4, 'cm'))

grid.arrange(j_lullaby_plot, live_once_plot, naked_plot, ncol=2)
```

***

"J's Lullaby" is the song with the least energy and loudness, while "Slow Hands," contrary to what its name suggests, is the song with the highest energy and loudness among all the songs in the indie corpus. When comparing these two songs, we can see that "Slow Hands"'s energy is widespread over many chroma, with pitch class B containing the most energy, while "j's lullaby" has most of it's energy focused on pitch classes C# and G#.
